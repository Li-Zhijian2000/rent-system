{"remainingRequest":"/home/zhijian/fourth/javaweb/v3-el-dashboard/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/zhijian/fourth/javaweb/v3-el-dashboard/src/components/TopNav.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/zhijian/fourth/javaweb/v3-el-dashboard/src/components/TopNav.vue","mtime":1590856522488},{"path":"/home/zhijian/fourth/javaweb/v3-el-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zhijian/fourth/javaweb/v3-el-dashboard/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/zhijian/fourth/javaweb/v3-el-dashboard/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zhijian/fourth/javaweb/v3-el-dashboard/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport debug from 'debug'\nimport { mapState } from 'vuex'\n\nconst log = debug('v3:TopNav')\n\nexport default {\n  name: 'TopNav',\n  data() {\n    return {\n      // tags: []\n    }\n  },\n  watch: {\n    '$route' (to, from) {\n      console.log(to, from)\n      log('to', to)\n      log('from', from)\n\n      this.addCachedView(to)\n    }\n  },\n  computed: {\n    tags () {\n      return this.$store.state.navTags.map((item) => {\n        return {\n          index: item.index,\n          title: item.title,\n          tabType: item.active ? 'success' : 'info',\n          active: item.active\n        }\n      })\n    }\n  },\n  methods: {\n    addCachedView (view) {\n      if (view.meta.type === 'menu') {\n        this.$store.dispatch('addNavTags', view)\n      }\n    },\n    closeTag (index) {\n      let tagId = this.tags[index].index\n      // 关闭处于激活状态的tag, 此时要切换路由\n      if (this.tags[index].active) {\n        if (this.tags[index + 1]) {\n          this.activeTag(this.tags[index + 1].index)\n        } else if (this.tags[index - 1]) {\n          this.activeTag(this.tags[index - 1].index)\n        } else {\n          this.$router.push(`/Home`)\n        }\n      } \n      \n      this.$store.dispatch('removeOneNavTag', {\n        index: tagId\n      })\n      // }\n      // log('dispatch removeOneNavTag done')\n      // let nextTag = this.navTags.length === 0 ? '/' : this.navTags[this.navTags.length - 1]\n      // this.activeTag(nextTag)\n    },\n    activeTag (tag) {\n      this.$router.push(tag)\n    }\n  },\n  mounted () {\n    this.addCachedView(this.$route)\n  }\n}\n",{"version":3,"sources":["TopNav.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TopNav.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <el-tag class=\"v3-tag\" v-for=\"(tag, index) in tags\" :key=\"tag.index\" closable \n    @close=\"closeTag(index)\" :type=\"tag.tabType\"\n    @click=\"activeTag(tag.index)\">\n      {{tag.title}}\n    </el-tag>\n  </div>\n</template>\n\n<script>\n  import debug from 'debug'\n  import { mapState } from 'vuex'\n\n  const log = debug('v3:TopNav')\n\n  export default {\n    name: 'TopNav',\n    data() {\n      return {\n        // tags: []\n      }\n    },\n    watch: {\n      '$route' (to, from) {\n        console.log(to, from)\n        log('to', to)\n        log('from', from)\n\n        this.addCachedView(to)\n      }\n    },\n    computed: {\n      tags () {\n        return this.$store.state.navTags.map((item) => {\n          return {\n            index: item.index,\n            title: item.title,\n            tabType: item.active ? 'success' : 'info',\n            active: item.active\n          }\n        })\n      }\n    },\n    methods: {\n      addCachedView (view) {\n        if (view.meta.type === 'menu') {\n          this.$store.dispatch('addNavTags', view)\n        }\n      },\n      closeTag (index) {\n        let tagId = this.tags[index].index\n        // 关闭处于激活状态的tag, 此时要切换路由\n        if (this.tags[index].active) {\n          if (this.tags[index + 1]) {\n            this.activeTag(this.tags[index + 1].index)\n          } else if (this.tags[index - 1]) {\n            this.activeTag(this.tags[index - 1].index)\n          } else {\n            this.$router.push(`/Home`)\n          }\n        } \n        \n        this.$store.dispatch('removeOneNavTag', {\n          index: tagId\n        })\n        // }\n        // log('dispatch removeOneNavTag done')\n        // let nextTag = this.navTags.length === 0 ? '/' : this.navTags[this.navTags.length - 1]\n        // this.activeTag(nextTag)\n      },\n      activeTag (tag) {\n        this.$router.push(tag)\n      }\n    },\n    mounted () {\n      this.addCachedView(this.$route)\n    }\n  }\n</script>\n\n<style>\n.v3-tag {\n  cursor: pointer;\n}\n</style>\n"]}]}